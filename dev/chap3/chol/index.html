<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Data Fitting and Cholesky Decomposition · Scientific Computing For Physicists</title><meta name="title" content="Data Fitting and Cholesky Decomposition · Scientific Computing For Physicists"/><meta property="og:title" content="Data Fitting and Cholesky Decomposition · Scientific Computing For Physicists"/><meta property="twitter:title" content="Data Fitting and Cholesky Decomposition · Scientific Computing For Physicists"/><meta name="description" content="Documentation for Scientific Computing For Physicists."/><meta property="og:description" content="Documentation for Scientific Computing For Physicists."/><meta property="twitter:description" content="Documentation for Scientific Computing For Physicists."/><meta property="og:url" content="https://book.jinguo-group.science/chap3/chol/"/><meta property="twitter:url" content="https://book.jinguo-group.science/chap3/chol/"/><link rel="canonical" href="https://book.jinguo-group.science/chap3/chol/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Scientific Computing For Physicists</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Become an Open-source Developer</span><ul><li><a class="tocitem" href="../../chap1/terminal/">Get a Terminal!</a></li><li><a class="tocitem" href="../../chap1/git/">Maintainability - Version Control</a></li><li><a class="tocitem" href="../../chap1/ci/">Correctness - Unit Tests</a></li></ul></li><li><span class="tocitem">Julia Programming Language</span><ul><li><a class="tocitem" href="../../chap2/julia-setup/">Setup Julia</a></li><li><a class="tocitem" href="../../chap2/julia-why/">Why Julia?</a></li><li><a class="tocitem" href="../../chap2/julia-type/">Types and Multiple-dispatch</a></li><li><a class="tocitem" href="../../chap2/julia-array/">Array and Broadcasting</a></li><li><a class="tocitem" href="../../chap2/julia-release/">My First Package</a></li><li><a class="tocitem" href="../../chap2/julia-fluid/">Project: Fluid dynamics</a></li></ul></li><li><span class="tocitem">Linear Algebra</span><ul><li><a class="tocitem" href="../linalg/">Matrix Computation</a></li><li><a class="tocitem" href="../lu/">Solving linear equations by LU factorization: Bottom-up</a></li><li><a class="tocitem" href="../qr/">QR Factorization: Bottom-up</a></li><li><a class="tocitem" href="../fft/">Fast Fourier transform</a></li><li><a class="tocitem" href="../sensitivity/">Sensitivity Analysis</a></li><li><a class="tocitem" href="../sparse/">Sparse Matrices and Graphs</a></li></ul></li><li><span class="tocitem">Tensors and Tensor Networks</span><ul><li><a class="tocitem" href="../tensors/">Tensor Operations</a></li></ul></li><li><span class="tocitem">Optimization</span><ul><li><a class="tocitem" href="../../chap4/optimization/">Optimization</a></li><li><a class="tocitem" href="../../chap4/ad/">Automatic Differentiation</a></li></ul></li><li><span class="tocitem">Randomness</span><ul><li><a class="tocitem" href="../../chap5/montecarlo/">Markov Chain Monte Carlo</a></li></ul></li><li><span class="tocitem">Appendix</span><ul><li><a class="tocitem" href="../../append/plotting/">Plotting recipes with CairoMakie</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Data Fitting and Cholesky Decomposition</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Data Fitting and Cholesky Decomposition</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/GiggleLiu/ScientificComputingForPhysicists" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/GiggleLiu/ScientificComputingForPhysicists/blob/main/docs/src/chap3/chol.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Data-Fitting-and-Cholesky-Decomposition"><a class="docs-heading-anchor" href="#Data-Fitting-and-Cholesky-Decomposition">Data Fitting and Cholesky Decomposition</a><a id="Data-Fitting-and-Cholesky-Decomposition-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Fitting-and-Cholesky-Decomposition" title="Permalink"></a></h1><p>Given <span>$m$</span> data points <span>$(t_i, y_i)$</span>, we wish to find the <span>$n$</span>-vector <span>$x$</span> of parameters that gives the &quot;best fit&quot; to the data by the model function <span>$f(t, x)$</span>, with</p><p class="math-container">\[f: \mathbb{R}^{n+1} \rightarrow \mathbb{R}\]</p><p class="math-container">\[\min_x\sum_{i=1}^m (y_i - f(t_i, x))^2\]</p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p class="math-container">\[f(x) = x_0 + x_1 t + x_2 t^2\]</p><p class="math-container">\[Ax = \left(\begin{matrix}
1 &amp; t_1 &amp; t_1^2\\
1 &amp; t_2 &amp; t_2^2\\
1 &amp; t_3 &amp; t_3^2\\
1 &amp; t_4 &amp; t_4^2\\
1 &amp; t_5 &amp; t_5^2\\
\vdots &amp; \vdots &amp; \vdots
\end{matrix}\right)
\left(\begin{matrix} x_1 \\ x_2 \\ x_3\end{matrix}\right) \approx
\left(\begin{matrix}y_1\\ y_2\\ y_3 \\ y_4 \\ y_5\\\vdots\end{matrix}\right) = b\]</p><p>The goal is to minimize <span>$\|Ax - b\|_2^2$</span>, we obtain the normal equations</p><p class="math-container">\[A^T Ax = A^T b\]</p><p>To solve the normal equations, we can use the pseudoinverse</p><p class="math-container">\[\begin{align*}
&amp;A^{+} = (A^T A)^{-1}A^T\\
&amp;x = A^+ b
\end{align*}\]</p><p>where <span>$A^+$</span> is the pseudoinverse of <span>$A$</span>.</p><p>The julia version</p><h2 id="The-geometric-interpretation"><a class="docs-heading-anchor" href="#The-geometric-interpretation">The geometric interpretation</a><a id="The-geometric-interpretation-1"></a><a class="docs-heading-anchor-permalink" href="#The-geometric-interpretation" title="Permalink"></a></h2><p>The residual is <span>$b-Ax$</span></p><p class="math-container">\[A^T(b - Ax) = 0\]</p><h2 id="Solving-Normal-Equations-with-Cholesky-decomposition"><a class="docs-heading-anchor" href="#Solving-Normal-Equations-with-Cholesky-decomposition">Solving Normal Equations with Cholesky decomposition</a><a id="Solving-Normal-Equations-with-Cholesky-decomposition-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-Normal-Equations-with-Cholesky-decomposition" title="Permalink"></a></h2><p>Step 1: Rectangular → Square</p><p class="math-container">\[A^TAx = A^T b\]</p><p>Step 2: Square → Triangular</p><p class="math-container">\[A^T A = LL^T\]</p><p>Step 3: Solve the triangular linear equation &quot;&quot;&quot;</p><h2 id="Issue:-The-Condition-Squaring-Effect"><a class="docs-heading-anchor" href="#Issue:-The-Condition-Squaring-Effect">Issue: The Condition-Squaring Effect</a><a id="Issue:-The-Condition-Squaring-Effect-1"></a><a class="docs-heading-anchor-permalink" href="#Issue:-The-Condition-Squaring-Effect" title="Permalink"></a></h2><p>The conditioning of a square linear system <span>$Ax = b$</span> depends only on the matrix, while the conditioning of a least squares problem <span>$Ax \approx b$</span> depends on both <span>$A$</span> and <span>$b$</span>.</p><p class="math-container">\[A = \left(\begin{matrix}1 &amp; 1\\ \epsilon &amp; 0 \\ 0 &amp; \epsilon \end{matrix}\right)\]</p><h2 id="Cholesky-decomposition"><a class="docs-heading-anchor" href="#Cholesky-decomposition">Cholesky decomposition</a><a id="Cholesky-decomposition-1"></a><a class="docs-heading-anchor-permalink" href="#Cholesky-decomposition" title="Permalink"></a></h2><p>Cholesky decomposition is a method of decomposing a positive-definite matrix into a product of a lower triangular matrix and its transpose. It is named after the mathematician André-Louis Cholesky, who developed the method in the early 1900s. The Cholesky decomposition is useful in many areas of mathematics and science, including linear algebra, numerical analysis, and statistics. It is often used in solving systems of linear equations, computing the inverse of a matrix, and generating random numbers with a given covariance matrix. The Cholesky decomposition is computationally efficient and numerically stable, making it a popular choice in many applications.</p><p>Given a positive definite symmetric matrix <span>$A\in \mathbb{R}^{n\times n}$</span>, the Cholesky decomposition is formally defined as</p><p class="math-container">\[A = LL^T,\]</p><p>where <span>$L$</span> is an upper triangular matrix.</p><p>The implementation of Cholesky decomposition is similar to LU decomposition.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; function chol!(a::AbstractMatrix)
       	n = size(a, 1)
       	@assert size(a, 2) == n
       	for k=1:n
       		a[k, k] = sqrt(a[k, k])
       		for i=k+1:n
       			a[i, k] = a[i, k] / a[k, k]
       		end
       		for j=k+1:n
       			for i=k+1:n
       				a[i,j] = a[i,j] - a[i, k] * a[j, k]
       			end
       		end
       	end
       	return a
       end</code><code class="nohighlight hljs ansi" style="display:block;">chol! (generic function with 1 method)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @testset &quot;cholesky&quot; begin
       	n = 10
       	Q, R = qr(randn(10, 10))
       	a = Q * Diagonal(rand(10)) * Q&#39;
       	L = chol!(copy(a))
       	@test tril(L) * tril(L)&#39; ≈ a
       	# cholesky(a) in Julia
       end</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: LoadError: UndefVarError: `@testset` not defined
in expression starting at REPL[2]:1</code></pre></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Friday 5 April 2024 16:31">Friday 5 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
