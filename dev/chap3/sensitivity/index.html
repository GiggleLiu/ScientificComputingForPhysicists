<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Sensitivity Analysis · Scientific Computing For Physicists</title><meta name="title" content="Sensitivity Analysis · Scientific Computing For Physicists"/><meta property="og:title" content="Sensitivity Analysis · Scientific Computing For Physicists"/><meta property="twitter:title" content="Sensitivity Analysis · Scientific Computing For Physicists"/><meta name="description" content="Documentation for Scientific Computing For Physicists."/><meta property="og:description" content="Documentation for Scientific Computing For Physicists."/><meta property="twitter:description" content="Documentation for Scientific Computing For Physicists."/><meta property="og:url" content="https://book.jinguo-group.science/chap3/sensitivity/"/><meta property="twitter:url" content="https://book.jinguo-group.science/chap3/sensitivity/"/><link rel="canonical" href="https://book.jinguo-group.science/chap3/sensitivity/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Scientific Computing For Physicists</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Become an Open-source Developer</span><ul><li><a class="tocitem" href="../../chap1/terminal/">Get a Terminal!</a></li><li><a class="tocitem" href="../../chap1/git/">Maintainability - Version Control</a></li><li><a class="tocitem" href="../../chap1/ci/">Correctness - Unit Tests</a></li></ul></li><li><span class="tocitem">Julia Programming Language</span><ul><li><a class="tocitem" href="../../chap2/julia-setup/">Setup Julia</a></li><li><a class="tocitem" href="../../chap2/julia-why/">Why Julia?</a></li><li><a class="tocitem" href="../../chap2/julia-type/">Types and Multiple-dispatch</a></li><li><a class="tocitem" href="../../chap2/julia-release/">My First Package</a></li><li><a class="tocitem" href="../../chap2/julia-fluid/">Project: Fluid dynamics</a></li></ul></li><li><span class="tocitem">Tensors (×)</span><ul><li><a class="tocitem" href="../array/">Array and Broadcasting</a></li><li><a class="tocitem" href="../linalg/">Basic Linear Algebra</a></li><li><a class="tocitem" href="../lu/">LU Decomposition</a></li><li class="is-active"><a class="tocitem" href>Sensitivity Analysis</a><ul class="internal"><li><a class="tocitem" href="#Issue:-An-Ill-Conditioned-Matrix"><span>Issue: An Ill Conditioned Matrix</span></a></li><li><a class="tocitem" href="#The-relative-error"><span>The relative error</span></a></li><li><a class="tocitem" href="#Numeric-experiment:-Floating-point-numbers-have-&quot;constant&quot;-relative-error"><span>Numeric experiment: Floating point numbers have &quot;constant&quot; relative error</span></a></li><li><a class="tocitem" href="#(Relative)-Condition-Number"><span>(Relative) Condition Number</span></a></li><li><a class="tocitem" href="#Measuring-the-size-vectors-and-matrices&quot;"><span>Measuring the size vectors and matrices&quot;</span></a></li><li><a class="tocitem" href="#Examples:-Vector-and-Matrix-Norms&quot;"><span>Examples: Vector and Matrix Norms&quot;</span></a></li><li class="toplevel"><a class="tocitem" href="#l0-norm-is-not-a-true-norm"><span>l0 norm is not a true norm</span></a></li><li><a class="tocitem" href="#Condition-Number-of-a-Linear-Operator&quot;"><span>Condition Number of a Linear Operator&quot;</span></a></li><li><a class="tocitem" href="#Numeric-experiment:-Numeric-experiment-on-condition-number"><span>Numeric experiment: Numeric experiment on condition number</span></a></li><li><a class="tocitem" href="#Positive-definite-symmetric-matrix&quot;"><span>Positive definite symmetric matrix&quot;</span></a></li><li><a class="tocitem" href="#Cholesky-decomposition"><span>Cholesky decomposition</span></a></li><li class="toplevel"><a class="tocitem" href="#Assignments"><span>Assignments</span></a></li></ul></li><li><a class="tocitem" href="../factorization/">Matrix factorization</a></li><li><a class="tocitem" href="../fft/">Fast Fourier transform</a></li><li><a class="tocitem" href="../tensors/">Tensor Operations</a></li><li><a class="tocitem" href="../cuda/">Arrays on GPU</a></li></ul></li><li><span class="tocitem">Optimization (×)</span><ul><li><a class="tocitem" href="../../chap4/combinatorial/">Combinatorial Optimization</a></li><li><a class="tocitem" href="../../chap4/optimization/">Optimization</a></li><li><a class="tocitem" href="../../chap4/ad/">Automatic Differentiation</a></li></ul></li><li><span class="tocitem">Randomness (×)</span><ul><li><a class="tocitem" href="../../chap5/montecarlo/">Markov Chain Monte Carlo</a></li></ul></li><li><span class="tocitem">Sparsity (×)</span><ul><li><a class="tocitem" href="../../chap6/sparse/">Sparse Matrices</a></li><li><a class="tocitem" href="../../chap6/compressedsensing/">Compressed sensing</a></li></ul></li><li><span class="tocitem">High Performance Computing (×)</span><ul><li><a class="tocitem" href="../../chap7/hpc/">MPI and OpenMP</a></li><li><a class="tocitem" href="../../chap7/cuda/">CUDA programming</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tensors (×)</a></li><li class="is-active"><a href>Sensitivity Analysis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Sensitivity Analysis</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/GiggleLiu/ScientificComputingForPhysicists" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/GiggleLiu/ScientificComputingForPhysicists/blob/main/docs/src/chap3/sensitivity.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Sensitivity-Analysis"><a class="docs-heading-anchor" href="#Sensitivity-Analysis">Sensitivity Analysis</a><a id="Sensitivity-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Sensitivity-Analysis" title="Permalink"></a></h1><p>Sensitivity analysis in linear algebra is the study of how changes in the input data or parameters of a linear system affect the output or solution of the system. It involves analyzing the sensitivity of the solution to changes in the coefficients of the system, the right-hand side vector, or the constraints of the problem. Sensitivity analysis can be used to determine the effect of small changes in the input data on the optimal solution, to identify critical parameters that affect the solution, and to assess the robustness of the solution to uncertainties or variations in the input data.</p><h2 id="Issue:-An-Ill-Conditioned-Matrix"><a class="docs-heading-anchor" href="#Issue:-An-Ill-Conditioned-Matrix">Issue: An Ill Conditioned Matrix</a><a id="Issue:-An-Ill-Conditioned-Matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Issue:-An-Ill-Conditioned-Matrix" title="Permalink"></a></h2><p>An ill conditioned matrix may produce unreliable result, or the output is very sensitive to the input. The following is an example of a matrix close to singular.</p><p class="math-container">\[A = \left(\begin{matrix}
0.913 &amp; 0.659\\
0.457 &amp; 0.330
\end{matrix}
\right)\]</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ill_conditioned_matrix = [0.913 0.659; 0.457 0.330]</code><code class="nohighlight hljs ansi" style="display:block;">2×2 Matrix{Float64}:
 0.913  0.659
 0.457  0.33</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; lures2 = lufact(ill_conditioned_matrix)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `lufact` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; lures2</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `lures2` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; cond(ill_conditioned_matrix)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `cond` not defined</code></pre><h2 id="The-relative-error"><a class="docs-heading-anchor" href="#The-relative-error">The relative error</a><a id="The-relative-error-1"></a><a class="docs-heading-anchor-permalink" href="#The-relative-error" title="Permalink"></a></h2><p>The relevant error in floating number system is the relative error.</p><ul><li>Absolute error: <span>$\|x - \hat x\|$</span></li><li>Relative error: <span>$\frac{\|x - \hat x\|}{\|x\|}$</span></li></ul><p>where <span>$\|\cdot\|$</span> is a measure of size.</p><h2 id="Numeric-experiment:-Floating-point-numbers-have-&quot;constant&quot;-relative-error"><a class="docs-heading-anchor" href="#Numeric-experiment:-Floating-point-numbers-have-&quot;constant&quot;-relative-error">Numeric experiment: Floating point numbers have &quot;constant&quot; relative error</a><a id="Numeric-experiment:-Floating-point-numbers-have-&quot;constant&quot;-relative-error-1"></a><a class="docs-heading-anchor-permalink" href="#Numeric-experiment:-Floating-point-numbers-have-&quot;constant&quot;-relative-error" title="Permalink"></a></h2><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; eps(Float64)</code><code class="nohighlight hljs ansi" style="display:block;">2.220446049250313e-16</code></pre><pre><code class="language-julia-repl hljs">n = 1000
reltol = zeros(2n+1)
for i=-n:n
    f = 2.0^i
    reltol[i+n+1] = log10(eps(f)) - log10(f)
end
plot(-n:n, reltol; label=&quot;relative error&quot;)</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; eps(1.0)/1.0</code><code class="nohighlight hljs ansi" style="display:block;">2.220446049250313e-16</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; eps(2.0)/2.0</code><code class="nohighlight hljs ansi" style="display:block;">2.220446049250313e-16</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; eps(sqrt(2))/sqrt(2)</code><code class="nohighlight hljs ansi" style="display:block;">1.570092458683775e-16</code></pre><h2 id="(Relative)-Condition-Number"><a class="docs-heading-anchor" href="#(Relative)-Condition-Number">(Relative) Condition Number</a><a id="(Relative)-Condition-Number-1"></a><a class="docs-heading-anchor-permalink" href="#(Relative)-Condition-Number" title="Permalink"></a></h2><p>Condition number is a measure of the sensitivity of a mathematical problem to changes or errors in the input data. It is a way to quantify how much the output of a function or algorithm can vary due to small changes in the input. A high condition number indicates that the problem is ill-conditioned, meaning that small errors in the input can lead to large errors in the output. A low condition number indicates that the problem is well-conditioned, meaning that small errors in the input have little effect on the output.</p><p>In short, the (relative) condition number of an operation <span>$f$</span> with input <span>$x$</span> measures the relative error amplication power of <span>$f$</span> with input <span>$x$</span>, which is formally defined as</p><p class="math-container">\[\lim _{\varepsilon \rightarrow 0^{+}}\,\sup _{\|\delta x\|\,\leq \,\varepsilon }{\frac {\|\delta f(x)\|/\|f(x)\|}{\|\delta x\|/\|x\|}}.\]</p><p>Quiz 1: What is the condition number of</p><p class="math-container">\[y = \exp(x)\]</p><p>Quiz 2: What is the condition number of</p><p class="math-container">\[a + b\]</p><p>With the obtained result, show why we should avoid subtracting two big floating point numbers?</p><h2 id="Measuring-the-size-vectors-and-matrices&quot;"><a class="docs-heading-anchor" href="#Measuring-the-size-vectors-and-matrices&quot;">Measuring the size vectors and matrices&quot;</a><a id="Measuring-the-size-vectors-and-matrices&quot;-1"></a><a class="docs-heading-anchor-permalink" href="#Measuring-the-size-vectors-and-matrices&quot;" title="Permalink"></a></h2><p>The vector <span>$p$</span>-norm is formally defined as&quot;</p><p class="math-container">\[\|v\|_p = \left(\sum_i{|v_i|^p}\right)^{1/p}\]</p><p>Similarly, the matrix <span>$p$</span>-norm is formally defined as</p><p class="math-container">\[\|A\|_p = \max_{x\neq 0} \frac{\|Ax\|_p}{\|x\|_p}\]</p><h2 id="Examples:-Vector-and-Matrix-Norms&quot;"><a class="docs-heading-anchor" href="#Examples:-Vector-and-Matrix-Norms&quot;">Examples: Vector and Matrix Norms&quot;</a><a id="Examples:-Vector-and-Matrix-Norms&quot;-1"></a><a class="docs-heading-anchor-permalink" href="#Examples:-Vector-and-Matrix-Norms&quot;" title="Permalink"></a></h2><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; norm([3, 4], 2)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `norm` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; norm([3, 4], 1)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `norm` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; norm([3, 4], Inf)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `norm` not defined</code></pre><h1 id="l0-norm-is-not-a-true-norm"><a class="docs-heading-anchor" href="#l0-norm-is-not-a-true-norm">l0 norm is not a true norm</a><a id="l0-norm-is-not-a-true-norm-1"></a><a class="docs-heading-anchor-permalink" href="#l0-norm-is-not-a-true-norm" title="Permalink"></a></h1><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; norm([3, 4], 0)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `norm` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; norm([3, 0], 0)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `norm` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; mat = randn(2, 2)</code><code class="nohighlight hljs ansi" style="display:block;">2×2 Matrix{Float64}:
 -0.446462  -0.667262
 -0.318032   1.46967</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; opnorm(mat, 1)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `opnorm` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; opnorm(mat, Inf)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `opnorm` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; opnorm(mat, 2)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `opnorm` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; opnorm(mat, 0)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `opnorm` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; cond(mat)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `cond` not defined</code></pre><h2 id="Condition-Number-of-a-Linear-Operator&quot;"><a class="docs-heading-anchor" href="#Condition-Number-of-a-Linear-Operator&quot;">Condition Number of a Linear Operator&quot;</a><a id="Condition-Number-of-a-Linear-Operator&quot;-1"></a><a class="docs-heading-anchor-permalink" href="#Condition-Number-of-a-Linear-Operator&quot;" title="Permalink"></a></h2><p>The condition number of a linear system <span>$Ax = b$</span> is defined as</p><p class="math-container">\[{\rm cond}(A) = \|A\| \|A^{-1}\|\]</p><p>Using the defintion of condition number, we have</p><p class="math-container">\[\begin{align}
{\rm cond(A, x)}&amp;=\lim _{\varepsilon \rightarrow 0^{+}}\,\sup _{\|\delta x\|\,\leq \,\varepsilon }{\frac {\|\delta (Ax)\|/\|A x\|}{\|\delta x\|/\|x\|}}\\
&amp;=\lim _{\varepsilon \rightarrow 0^{+}}\,\sup _{\|\delta x\|\,\leq \,\varepsilon }{\frac {\|A\delta x\|\|x\|}{\|\delta x\|\|Ax\|}}
\end{align}\]</p><p>Let <span>$y = Ax$</span>, we have</p><p class="math-container">\[\begin{align}
{\rm cond(A, x)}&amp;=\lim _{\varepsilon \rightarrow 0^{+}}\,\sup _{\|\delta x\|\,\leq \,\varepsilon }{\frac {\|A\delta x\|\|A^{-1}y\|}{\|\delta x\|\|y\|}}\\
&amp;=\|A\|\frac{\|A^{-1}y\|}{\|y\|}
\end{align}\]</p><p>Suppose we want to get an upper bound for any input <span>$x$</span>, then using the definiton of matrix norm, we have</p><p class="math-container">\[{\rm cond}(A) = \|A\|\sup_y \frac{\|A^{-1}y\|}{\|y\|} = \|A\| \|A^{-1}\|\]</p><h2 id="Numeric-experiment:-Numeric-experiment-on-condition-number"><a class="docs-heading-anchor" href="#Numeric-experiment:-Numeric-experiment-on-condition-number">Numeric experiment: Numeric experiment on condition number</a><a id="Numeric-experiment:-Numeric-experiment-on-condition-number-1"></a><a class="docs-heading-anchor-permalink" href="#Numeric-experiment:-Numeric-experiment-on-condition-number" title="Permalink"></a></h2><p>We randomly generate matrices of size <span>$10\times 10$</span> and show the condition number approximately upper bounds the numeric error amplification factor of a linear equation solver.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; n = 1000</code><code class="nohighlight hljs ansi" style="display:block;">1000</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; p = 2</code><code class="nohighlight hljs ansi" style="display:block;">2</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; errors = zeros(n)</code><code class="nohighlight hljs ansi" style="display:block;">1000-element Vector{Float64}:
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 ⋮
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; conds = zeros(n)</code><code class="nohighlight hljs ansi" style="display:block;">1000-element Vector{Float64}:
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 ⋮
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for k = 1:n
           A = rand(10, 10)
           b = rand(10)
           dx = A \ b
           sx = Float32.(A) \ Float32.(b)
           errors[k] = (norm(sx - dx, p)/norm(dx, p)) / (norm(b-Float32.(b), p)/norm(b, p))
           conds[k] = cond(A, p)
       end</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `norm` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plt = plot(conds, conds; label=&quot;condition number&quot;, xlim=(1, 10000), ylim=(1, 10000), xscale=:log10, yscale=:log10)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `plot` not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; scatter!(plt, conds, errors; label=&quot;samples&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `scatter!` not defined</code></pre><h2 id="Positive-definite-symmetric-matrix&quot;"><a class="docs-heading-anchor" href="#Positive-definite-symmetric-matrix&quot;">Positive definite symmetric matrix&quot;</a><a id="Positive-definite-symmetric-matrix&quot;-1"></a><a class="docs-heading-anchor-permalink" href="#Positive-definite-symmetric-matrix&quot;" title="Permalink"></a></h2><ul><li>(Real) Symmetric: <span>$A = A^T$</span>,</li><li>Positive definite: <span>$x^T A x &gt; 0$</span> for all <span>$x \neq 0$</span>.</li></ul><h2 id="Cholesky-decomposition"><a class="docs-heading-anchor" href="#Cholesky-decomposition">Cholesky decomposition</a><a id="Cholesky-decomposition-1"></a><a class="docs-heading-anchor-permalink" href="#Cholesky-decomposition" title="Permalink"></a></h2><p>Cholesky decomposition is a method of decomposing a positive-definite matrix into a product of a lower triangular matrix and its transpose. It is named after the mathematician André-Louis Cholesky, who developed the method in the early 1900s. The Cholesky decomposition is useful in many areas of mathematics and science, including linear algebra, numerical analysis, and statistics. It is often used in solving systems of linear equations, computing the inverse of a matrix, and generating random numbers with a given covariance matrix. The Cholesky decomposition is computationally efficient and numerically stable, making it a popular choice in many applications.</p><p>Given a positive definite symmetric matrix <span>$A\in \mathbb{R}^{n\times n}$</span>, the Cholesky decomposition is formally defined as</p><p class="math-container">\[A = LL^T,\]</p><p>where <span>$L$</span> is an upper triangular matrix.</p><p>The implementation of Cholesky decomposition is similar to LU decomposition.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; function chol!(a::AbstractMatrix)
       	n = size(a, 1)
       	@assert size(a, 2) == n
       	for k=1:n
       		a[k, k] = sqrt(a[k, k])
       		for i=k+1:n
       			a[i, k] = a[i, k] / a[k, k]
       		end
       		for j=k+1:n
       			for i=k+1:n
       				a[i,j] = a[i,j] - a[i, k] * a[j, k]
       			end
       		end
       	end
       	return a
       end</code><code class="nohighlight hljs ansi" style="display:block;">chol! (generic function with 1 method)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @testset &quot;cholesky&quot; begin
       	n = 10
       	Q, R = qr(randn(10, 10))
       	a = Q * Diagonal(rand(10)) * Q&#39;
       	L = chol!(copy(a))
       	@test tril(L) * tril(L)&#39; ≈ a
       	# cholesky(a) in Julia
       end</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: LoadError: UndefVarError: `@testset` not defined
in expression starting at REPL[2]:1</code></pre><h1 id="Assignments"><a class="docs-heading-anchor" href="#Assignments">Assignments</a><a id="Assignments-1"></a><a class="docs-heading-anchor-permalink" href="#Assignments" title="Permalink"></a></h1><ol><li><p>Get the relative condition number of division operation <span>$a/b$</span>.</p></li><li><p>Classify each of the following matrices as well-conditioned or ill-conditioned:</p></li></ol><p class="math-container">\[(a). ~~\left(\begin{matrix}10^{10} &amp; 0\\ 0 &amp; 10^{-10}\end{matrix}\right)\]</p><p class="math-container">\[(b). ~~\left(\begin{matrix}10^{10} &amp; 0\\ 0 &amp; 10^{10}\end{matrix}\right)\]</p><p class="math-container">\[(c). ~~\left(\begin{matrix}10^{-10} &amp; 0\\ 0 &amp; 10^{-10}\end{matrix}\right)\]</p><p class="math-container">\[(d). ~~\left(\begin{matrix}1 &amp; 2\\ 2 &amp; 4\end{matrix}\right)\]</p><ol><li>Implement the Gauss-Jordan elimination algorithm to compute matrix inverse. In the following example, we first create an augmented matrix <span>$(A | I)$</span>. Then we apply the Gauss-Jordan elimination matrices on the left. The final result is stored in the augmented matrix as <span>$(I, A^{-1})$</span>.</li></ol><p><img src="https://user-images.githubusercontent.com/6257240/222182865-c2a1aa28-946a-4acb-8df8-f5d7da93c3ee.png" alt/></p><p>Task: Please implement a function <code>gauss_jordan</code> that computes the inverse for a matrix at any size. Please also include the following test in your submission.</p><pre><code class="language-julia hljs">@testset &quot;Gauss Jordan&quot; begin
	n = 10
	A = randn(n, n)
	@test gauss_jordan(A) * A ≈ Matrix{Float64}(I, n, n)
end</code></pre><p>Simular to computing Guassian elimination with elementary elimination matrices, computing the inverse can be done by repreatedly applying the Guass-Jordan elimination matrix and convert the target matrix to identity.</p><p class="math-container">\[SN_{n}N_{n-1}\ldots N_1 A = I\]</p><p>Then</p><p class="math-container">\[A^{-1} = SN_{n}N_{n-1}\ldots N_1\]</p><p>Here, the Gauss-Jordan elimination matrix <span>$N_k$</span> eliminates the <span>$k$</span>th column except the diagonal element <span>$a_{kk}$</span>.</p><p class="math-container">\[N_k = \left(\begin{matrix}

1 &amp; \ldots &amp; 0 &amp; -m_1 &amp; 0 &amp; \ldots &amp; 0\\
\vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
0 &amp; \ldots &amp; 1 &amp; -m_{k-1} &amp; 0 &amp; \ldots &amp; 0\\
0 &amp; \ldots &amp; 0 &amp; 1 &amp; 0 &amp; \ldots &amp; 0\\
0 &amp; \ldots &amp; 0 &amp; -m_{k+1} &amp; 1 &amp; \ldots &amp; 0\\
\vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
0 &amp; \ldots &amp; 0 &amp; -m_{n} &amp; 0 &amp; \ldots &amp; 1\\

\end{matrix}\right)\]</p><p>where <span>$m_i = a_i/a_k$</span>.</p><p><span>$S$</span> is a diagonal matrix.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lu/">« LU Decomposition</a><a class="docs-footer-nextpage" href="../factorization/">Matrix factorization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Wednesday 6 March 2024 09:24">Wednesday 6 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
